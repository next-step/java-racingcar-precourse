# java-racingcar-precourse

# 기능 목록

## Model

### Racer Entity

#### Data
- [x] 자동차 경주자는 이름이 있다.
  - [x] NAME_MAX_LENGTH 이하의 길이여야 한다.
- [x] 자동차 경주자는 이동한 거리를 정수로 기록한다.

#### Act
- [x] 자동차 경주자는 전진할 수 있다.
  - [x] 전진할 때 숫자로 된 입력을 받는다.
  - [x] 입력받은 숫자가 threshold 값을 넘어야 전진한다. 
  - [x] threshold 값을 넘지 못하면 전진하지 않는다.
- [ ] ~~자동차 경주자는 이름과 함께 이동한 거리를 출력할 수 있다.~~
- [x] 자동차 경주자는 숫자로 된 입력을 받아, 우승했는지 여부를 알려준다.

### Racer VO

#### Data
- [x] 자동차 경주자는 이름이 있다.
- [x] 자동차 경주자는 이동한 거리를 정수로 기록한다.
- [x] 자동차 경주자는 우승 여부를 기록한다. 

### Controller

#### Data
- [x] 자동차 경주자 목록을 가지고 있는다.
- [x] 자동차 경주 진행 시도 횟수를 가지고 있는다.
- [x] 현재 자동차 경주 진행 횟수를 가지고 있는다.

#### Act
- [x] 자동차 이름을 1개의 문자열로 입력받아 자동차 목록을 생성한다.
  - [x] 자동차 이름은 쉼표를 기준으로 구분하며, 이름이 NAME_MAX_LENGTH보다 길 경우 IllegalArgumentException을 발생시킨다.
- [x] 경주 게임을 진행할 횟수를 입력 받는다.
  - [x] 횟수에는 최댓값 제한은 없으며, 음수 또는 숫자가 아닐 시 IllegalArgumentException을 발생시킨다.
  - [x] 입력 받은 숫자로 경주 진행 시도 횟수를 초기화하고, 현재 자동차 경주 진행 횟수는 0으로 리셋한다.
- [x] 경주 게임을 1번 진행한다.
  - [x] 만약 자동차 목록 또는 경주 게임 진행 횟수가 세팅이 안 되었을 경우 IllegalStateException을 발생시킨다.
  - [x] 이미 게임이 종료 되었을 경우 IllegalStateException을 발생시킨다.
  - [x] 게임이 끝나면 Racer VO 목록과 게임 종료 여부를 반환한다.

### View

#### Data
- [x] 자동차 경주 컨트롤러를 가지고 있는다.

#### Act
- [x] 자동차 경주 게임을 시작한다.
  - [x] 경주할 자동차 이름을 입력받는다.
  - [x] 시도할 횟수를 입력 받는다.
  - [x] 자동차 경주 게임을 진행하며 매번 결과를 출력한다.
  - [x] 최종 우승자를 출력한다.
  - [x] 입력을 받을 때 에러가 발생하면 "[ERROR]"로 시작하는 에러 메시지를 출력 후 그 부분부터 입력을 다시 받는다.

### Util

### RandomNumberGenerator

#### Act
- [x] 입력 받은 숫자 범위에서 무작위 정수를 생성한다.

### ~~ErrorMessageGenerator~~

#### ~~Act~~
- [ ] ~~입력 받은 에러 메세지를 정해진 포맷으로 바꿔서 반환한다.~~

# 후기

기능 단위를 먼저 쭉 정리하고 개발을 시작하니까 좀 더 수월하게 할 수 있었습니다. 고민도 미리 하고 어느정도 설계가 나온 상태여서 그런 것 같습니다. 물론 진행 과정에서 여러모로 수정이 있었지만, 크게 수정된 것은 없었던 것 같습니다.


RandomNumberGenerator를 Mocking하는 과정에서, mocking은 static 키워드와 바이트 코드 수준에서의 선언 순서로 인한 문제점이 있다는 것을 처음 알게 되었습니다. 여러 해결 방법을 찾아보고 직접 적용해볼 수 있어서 흥미로웠습니다. 그동안 별 생각 없이 static 키워드와 함께 Util 클래스를 자주 사용하고, 테스트에서도 mockStatic를 사용했습니다. 근데 테스팅 과정에서 static은 bad pattern 이라는 의견도 많이 보여서 스스로 static이 포함된 테스트 코드의 작성 난이도를 고민해보게 되었습니다.


Generator를 싱글톤 또는 static 메소드로 쓰고는 싶은데, static 키워드 때문에 테스팅이 어려워져서 고민이 좀 많아졌습니다. Spring을 쓰면 Util class를 Bean으로 등록해서 싱글톤으로 쓰면 되지만, 이번 프로그램에서는 DI Container 같은 것 없이 직접 의존성을 해결해줘야 하다 보니까 더 고민이 많았네요.


고민거리가 많았던 토이 프로젝트라 재밌었습니다ㅎㅎ